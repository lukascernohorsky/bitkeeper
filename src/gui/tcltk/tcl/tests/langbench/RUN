test X$LANGBENCH = X && {
        LANGBENCH=.
        test -d langbench && LANGBENCH=langbench
}
test X$TCLSH = X && {
        test -x gui/bin/tclsh && TCLSH=gui/bin/tclsh
        test -x ../gui/bin/tclsh && TCLSH=../gui/bin/tclsh
}
test X$TCLSH = X && {
        echo Please set TCLSH
        exit 1
}
test X$PYTHON = X && PYTHON=python
test X$RUBY = X && RUBY=ruby
test "X$LANGS" = X && LANGS="py rb tcl"
test "X$TESTS" = X && TESTS="cat grep hash loop proc fib sort wc"
export TCL_REGEXP_PCRE=1
echo "langbench version 0.6 results:"
echo -n "lang   "
for i in $TESTS
do      echo -n "$i     "
done
echo ""
for lang in $LANGS
do
        case $lang in
            py) CMD=$PYTHON; EXT=py;;
            rb) CMD=$RUBY; EXT=rb;;
            tcl) CMD=$TCLSH; EXT=tcl;;
        esac
        N=1
        test X$RUNS = X || N=$RUNS
        while (($N > 0))
        do
                printf "%-8s" $lang
                for test in $TESTS
                do
                        DATA=DATA
                        test $test = wc && DATA=SMALL
                        export LANG_TEST=$test
                        for run in 1 2 3
                        do      time $CMD $LANGBENCH/${test}.${EXT} $DATA > /dev/null
                        done 2>&1 |
                        awk '/^real/ { val=$2; sub(/^[0-9]+m/,"",val); sub(/s$/, "", val); if(min=="" || val+0 < min) min=val+0 }
                             END { if (min=="") min=0; printf "%-8.2f", min }'
                done
                printf "\n"
                N=`expr $N - 1`
        done
done
exit 0
